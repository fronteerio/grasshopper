/**
 * Copyright (c) 2015 "Fronteer LTD"
 * Grasshopper Event Engine
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU Affero General Public License as
 * published by the Free Software Foundation, either version 3 of the
 * License, or (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU Affero General Public License for more details.
 *
 * You should have received a copy of the GNU Affero General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 */

var _ = require('lodash');
var moment = require('moment');

var Term = require('./term').Term;

var _termDateMoment = function(dateStr) {
    return moment(dateStr, 'YYYY-MM-DD');
};

// The start dates for each term for the forseeable future. Note that these
// dates do NOT start on a Thursday
var TERM_DATES = {
    '2014': [_termDateMoment('2014-10-7'), _termDateMoment('2015-1-13'), _termDateMoment('2015-4-21')],
    '2015': [_termDateMoment('2015-10-6'), _termDateMoment('2016-1-12'), _termDateMoment('2016-4-19')],
    '2016': [_termDateMoment('2016-10-4'), _termDateMoment('2017-1-17'), _termDateMoment('2017-4-25')],
    '2017': [_termDateMoment('2017-10-3'), _termDateMoment('2018-1-16'), _termDateMoment('2018-4-24')],
    '2018': [_termDateMoment('2018-10-2'), _termDateMoment('2019-1-15'), _termDateMoment('2019-4-23')],
    '2019': [_termDateMoment('2019-10-8'), _termDateMoment('2020-1-14'), _termDateMoment('2020-4-21')],
    '2020': [_termDateMoment('2020-10-6'), _termDateMoment('2021-1-19'), _termDateMoment('2021-4-27')],
    '2021': [_termDateMoment('2021-10-5'), _termDateMoment('2022-1-18'), _termDateMoment('2022-4-26')],
    '2022': [_termDateMoment('2022-10-4'), _termDateMoment('2023-1-17'), _termDateMoment('2023-4-25')],
    '2023': [_termDateMoment('2023-10-3'), _termDateMoment('2024-1-16'), _termDateMoment('2024-4-23')],
    '2024': [_termDateMoment('2024-10-8'), _termDateMoment('2025-1-21'), _termDateMoment('2025-4-29')],
    '2025': [_termDateMoment('2025-10-7'), _termDateMoment('2026-1-20'), _termDateMoment('2026-4-28')],
    '2026': [_termDateMoment('2026-10-6'), _termDateMoment('2027-1-19'), _termDateMoment('2027-4-27')],
    '2027': [_termDateMoment('2027-10-5'), _termDateMoment('2028-1-18'), _termDateMoment('2028-4-25')],
    '2028': [_termDateMoment('2028-10-3'), _termDateMoment('2029-1-16'), _termDateMoment('2029-4-24')],
    '2029': [_termDateMoment('2029-10-2'), _termDateMoment('2030-1-15'), _termDateMoment('2030-4-23')]
};

// The official abbreviations for `Michaelmas`, `Lent` and `Easter`
var TERM_NAMES = module.exports.TERM_NAMES = ['Mi', 'Le', 'Ea'];

// The official set of abbreviations for the days of the week starting on Sunday
var DAY_NAMES = module.exports.DAY_NAMES = ['Su', 'M', 'Tu', 'W', 'Th', 'F', 'Sa'];

// A flat set of all the `Term` objects for the forseeable future. This data will
// be used to find the closest term to a given date
var ALL_TERMS = module.exports.ALL_TERMS = [];

// Build up the set of terms
_.each(TERM_DATES, function(termDates, year) {
    _.each(termDates, function(termDate, i) {
        ALL_TERMS.push(new Term(year, termDate, i));
    });
});
